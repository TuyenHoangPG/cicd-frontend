(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{206:function(e,t,n){},351:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(44),i=n.n(r),o=(n(206),n(25)),s=n(38),l=n(359),d=n(355),u=n(356),j=n(86),b=n(104);n(352),n(207),n(353);b.a.initializeApp({apiKey:"AIzaSyBsTPhPtD453K3vYrMWSreC1mDv3ZlOEfw",authDomain:"chat-app-b97b6.firebaseapp.com",projectId:"chat-app-b97b6",storageBucket:"chat-app-b97b6.appspot.com",messagingSenderId:"379155265353",appId:"1:379155265353:web:d932cab9e24d428123cc98",measurementId:"G-Y9SRZH03D7"}),b.a.analytics();var p=b.a.auth(),h=b.a.firestore();"localhost"===window.location.hostname&&(p.useEmulator("http://localhost:9099"),h.useEmulator("localhost","8080"));var O=b.a,m=n(8),x=n(3),f=function(){var e=Object(s.a)(Object(o.a)().mark((function e(t,n){var a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.collection(t),e.next=3,a.add(Object(x.a)(Object(x.a)({},n),{},{createdAt:O.firestore.FieldValue.serverTimestamp()}));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,a=[],c=[],r=[],i=0;i<n;i++)a[i]=!1;!function e(i){for(var o=0;o<n;o++)a[o]||(a[o]=!0,c[i]=t[o],i===n-1&&r.push(c.join(" ")),e(i+1),a[o]=!1)}(0);var o=r.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(m.a)(e),Object(m.a)(n))}),[]);return o},g=n(7),y=l.a.Title,w=new O.auth.FacebookAuthProvider,C=new O.auth.GoogleAuthProvider;function I(){var e=function(){var e=Object(s.a)(Object(o.a)().mark((function e(t){var n,a,c;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,p.signInWithPopup("facebook"===t?w:C);case 3:if(n=e.sent,a=n.additionalUserInfo,c=n.user,console.log(c),null===a||void 0===a||!a.isNewUser){e.next=10;break}return e.next=10,f("users",{displayName:c.displayName,email:c.email,photoURL:c.photoURL,uid:c.uid,providerId:a.providerId,keywords:v(c.displayName)});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsx)("div",{children:Object(g.jsx)(d.a,{justify:"center",style:{height:800},children:Object(g.jsxs)(u.a,{span:8,children:[Object(g.jsx)(y,{style:{textAlign:"center"},level:3,children:"Fun Chat"}),Object(g.jsx)(j.a,{style:{width:"100%",marginBottom:5},onClick:function(){return e("google")},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Google"}),Object(g.jsx)(j.a,{style:{width:"100%"},onClick:function(){return e("facebook")},children:"\u0110\u0103ng nh\u1eadp b\u1eb1ng Facebook"})]})})})}var N=n(153),R=n(33),k=n(47),U=n(361),A=n(48),S=n(367),V=n(5),L=n(357),M=Object(a.createContext)();function F(e){var t=e.children,n=Object(a.useState)(null),c=Object(V.a)(n,2),r=c[0],i=c[1],o=Object(a.useState)(!0),s=Object(V.a)(o,2),l=s[0],d=s[1],u=Object(R.f)();return Object(a.useEffect)((function(){var e=p.onAuthStateChanged((function(e){if(e){var t=e.displayName,n=e.email,a=e.uid,c=e.photoURL;i({displayName:t,email:n,uid:a,photoURL:c}),u.push("/")}else i({}),u.push("/login");d(!1)}));return function(){e()}}),[u]),Object(g.jsx)(M.Provider,{value:{user:r},children:l?Object(g.jsx)(L.a,{}):t})}function T(e,t){var n=Object(a.useState)([]),c=Object(V.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){var n=h.collection(e).orderBy("createdAt","asc");if(t){var a=t.fieldName,c=t.operator,r=t.compareValue;if(!r||!r.length)return;n=n.where(a,c,r)}var o=n.onSnapshot((function(e){var t=e.docs.map((function(e){return Object(x.a)(Object(x.a)({},e.data()),{},{id:e.id})}));i(t)}));return function(){o()}}),[e,t]),r}var _,P,z=Object(a.createContext)();function E(e){var t=e.children,n=Object(a.useContext)(M).user.uid,c=Object(a.useState)(!1),r=Object(V.a)(c,2),i=r[0],o=r[1],s=Object(a.useState)(!1),l=Object(V.a)(s,2),d=l[0],u=l[1],j=Object(a.useState)(null),b=Object(V.a)(j,2),p=b[0],h=b[1],O=T("rooms",Object(a.useMemo)((function(){return{fieldName:"members",operator:"array-contains",compareValue:n}}),[n])),m=Object(a.useMemo)((function(){return O.find((function(e){return e.id===p}))||{}}),[O,p]),x=T("users",Object(a.useMemo)((function(){return{fieldName:"uid",operator:"in",compareValue:m.members}}),[null===m||void 0===m?void 0:m.members]));return Object(g.jsx)(z.Provider,{value:{rooms:O,isAddRoomVisible:i,setIsAddRoomVisible:o,selectedRoomId:p,setSelectedRoomId:h,selectedRoom:m,members:x,isInviteMemberVisible:d,setIsInviteMemberVisible:u},children:t})}var D=U.a.Panel,B=Object(A.a)(D)(_||(_=Object(k.a)(["\n  &&& {\n    .ant-collapse-header,\n    p {\n      color: white;\n    }\n\n    .ant-collapse-content-box {\n      padding: 0 40px;\n    }\n    .add-room {\n      color: white;\n      padding: 0;\n    }\n  }\n"]))),G=Object(A.a)(l.a.Link)(P||(P=Object(k.a)(["\n  display: block;\n  margin-bottom: 5px;\n  color: white;\n"])));function K(){var e=Object(a.useContext)(z),t=e.rooms,n=e.setIsAddRoomVisible,c=e.setSelectedRoomId,r=Object(a.useCallback)((function(){n(!0)}),[n]),i=Object(a.useCallback)((function(e){c(e)}),[c]);return Object(g.jsx)(U.a,{ghost:!0,defaultActiveKey:["1"],children:Object(g.jsxs)(B,{header:"Danh s\xe1ch c\xe1c ph\xf2ng",children:[t&&t.map((function(e){return Object(g.jsx)(G,{onClick:function(){return i(e.id)},children:e.name},e.id)})),Object(g.jsx)(j.a,{type:"text",icon:Object(g.jsx)(S.a,{}),className:"add-room",onClick:r,children:"Th\xeam ph\xf2ng"})]},"1")})}var H,J,W=n(363),Y=A.a.div(H||(H=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 12px 18px;\n  border-bottom: 1px solid rgba(82, 38, 83);\n\n  .username {\n    color: white;\n    margin-left: 5px;\n  }\n"])));function Z(){var e,t=Object(a.useContext)(M).user,n=t.displayName,c=t.photoURL;return Object(g.jsxs)(Y,{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(W.a,{src:c,children:c?"":null===n||void 0===n||null===(e=n.charAt(0))||void 0===e?void 0:e.toUpperCase()}),Object(g.jsx)(l.a.Text,{className:"username",children:n})]}),Object(g.jsx)(j.a,{ghost:!0,onClick:function(){p.signOut()},children:"\u0110\u0103ng xu\u1ea5t"})]})}var q=A.a.div(J||(J=Object(k.a)(["\n  background-color: #3f0e40;\n  color: white;\n  height: 100vh;\n"])));function Q(){return Object(g.jsx)(q,{children:Object(g.jsxs)(d.a,{children:[Object(g.jsx)(u.a,{span:24,children:Object(g.jsx)(Z,{})}),Object(g.jsx)(u.a,{span:24,children:Object(g.jsx)(K,{})})]})})}var X,$,ee,te,ne,ae,ce,re=n(360),ie=n(72),oe=n(364),se=n(366),le=n(368),de=n(358),ue=A.a.div(X||(X=Object(k.a)(["\n  margin-bottom: 10px;\n  .author {\n    margin-left: 5px;\n    font-weight: bold;\n  }\n  .date {\n    margin-left: 10px;\n    font-size: 11px;\n    color: #a7a7a7;\n  }\n\n  .content {\n    margin-left: 30px;\n  }\n"]))),je=function(e){var t="";return e&&(t=(t=Object(de.a)(new Date(1e3*e),new Date)).charAt(0).toUpperCase()+t.slice(1)),t};function be(e){var t,n=e.text,a=e.displayName,c=e.createdAt,r=e.photoURL;return Object(g.jsxs)(ue,{children:[Object(g.jsxs)("div",{children:[Object(g.jsx)(W.a,{src:r,size:"small",children:r?"":null===a||void 0===a||null===(t=a.charAt(0))||void 0===t?void 0:t.toUpperCase()}),Object(g.jsx)(l.a.Text,{className:"author",children:a}),Object(g.jsx)(l.a.Text,{className:"date",children:je(null===c||void 0===c?void 0:c.seconds)})]}),Object(g.jsx)("div",{children:Object(g.jsx)(l.a.Text,{className:"content",children:n})})]})}var pe=A.a.div($||($=Object(k.a)(["\n  height: 100vh;\n"]))),he=A.a.div(ee||(ee=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  height: 56px;\n  padding 0 16px;\n  align-items: center;\n  border-bottom: 1px solid rgba(230, 230, 230);\n\n  .header {\n    &__info {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n    }\n\n    &__title {\n      margin: 0;\n      font-weight: bold;\n    }\n\n    &__description {\n      font-size: 12px;\n    }\n  }\n"]))),Oe=A.a.div(te||(te=Object(k.a)(["\n  display: flex;\n  align-items: center;\n"]))),me=A.a.div(ne||(ne=Object(k.a)(["\n  height: calc(100vh - 56px);\n  display: flex;\n  flex-direction: column;\n  padding: 11px;\n  justify-content: flex-end;\n"]))),xe=Object(A.a)(re.a)(ae||(ae=Object(k.a)(["\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2px 2px 2px 0;\n  border: 1px solid rgba(230, 230, 230);\n  border-radius: 2px;\n  .ant-form-item {\n    flex: 1;\n    margin-bottom: 0;\n  }\n"]))),fe=A.a.div(ce||(ce=Object(k.a)(["\n  max-height: 100%;\n  overflow-y: auto;\n"])));function ve(){var e=Object(a.useContext)(M).user,t=e.uid,n=e.photoURL,c=e.displayName,r=Object(a.useContext)(z),i=r.selectedRoom,o=r.members,s=r.setIsInviteMemberVisible,l=r.selectedRoomId,d=re.a.useForm(),u=Object(V.a)(d,1)[0],b=Object(a.useState)(""),p=Object(V.a)(b,2),h=p[0],O=p[1],m=function(e){f("messages",{text:h,uid:t,photoURL:n,roomId:i.id,displayName:c}),u.resetFields(["message"])},x=T("messages",Object(a.useMemo)((function(){return{fieldName:"roomId",operator:"==",compareValue:l}}),[l]));return Object(g.jsx)(pe,{children:null!==i&&void 0!==i&&i.id?Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(he,{children:[Object(g.jsxs)("div",{className:"header__info",children:[Object(g.jsx)("p",{className:"header__title",children:i.name}),Object(g.jsx)("span",{className:"header__description",children:i.description})]}),Object(g.jsxs)(Oe,{children:[Object(g.jsx)(j.a,{icon:Object(g.jsx)(le.a,{}),type:"text",onClick:function(){return s(!0)},children:"M\u1eddi"}),Object(g.jsx)(W.a.Group,{size:"small",maxCount:2,children:o&&o.map((function(e){var t,n;return Object(g.jsx)(ie.a,{title:e.displayName,children:Object(g.jsx)(W.a,{src:e.photoURL,children:e.photoURL?"":null===(t=e.displayName)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})},e.id)}))})]})]}),Object(g.jsxs)(me,{children:[Object(g.jsx)(fe,{children:x&&x.map((function(e){return Object(g.jsx)(be,{text:e.text,photoURL:e.photoURL,displayName:e.displayName,createdAt:e.createdAt},e.id)}))}),Object(g.jsxs)(xe,{form:u,children:[Object(g.jsx)(re.a.Item,{name:"message",children:Object(g.jsx)(oe.a,{placeholder:"Nh\u1eadp tin nh\u1eafn",bordered:!1,autoComplete:"off",onChange:function(e){O(e.target.value)},onPressEnter:m})}),Object(g.jsx)(j.a,{type:"primary",onClick:m,children:"G\u1eedi"})]})]})]}):Object(g.jsx)(se.a,{message:"H\xe3y ch\u1ecdn ph\xf2ng",type:"info",showIcon:!0,style:{margin:5},closable:!0})})}function ge(){return Object(g.jsx)("div",{children:Object(g.jsxs)(d.a,{children:[Object(g.jsx)(u.a,{span:6,children:Object(g.jsx)(Q,{})}),Object(g.jsx)(u.a,{span:18,children:Object(g.jsx)(ve,{})})]})})}var ye=n(362);function we(){var e=Object(a.useContext)(z),t=e.isAddRoomVisible,n=e.setIsAddRoomVisible,c=Object(a.useContext)(M).user.uid,r=re.a.useForm(),i=Object(V.a)(r,1)[0],l=function(){var e=Object(s.a)(Object(o.a)().mark((function e(){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("rooms",Object(x.a)(Object(x.a)({},i.getFieldValue()),{},{members:[c]}));case 2:i.resetFields(),n(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(g.jsx)("div",{children:Object(g.jsx)(ye.a,{title:"T\u1ea1o ph\xf2ng",visible:t,onOk:l,onCancel:function(){i.resetFields(),n(!1)},children:Object(g.jsxs)(re.a,{form:i,layout:"vertical",children:[Object(g.jsx)(re.a.Item,{label:"T\xean ph\xf2ng",name:"name",children:Object(g.jsx)(oe.a,{placeholder:"Nh\u1eadp t\xean ph\xf2ng"})}),Object(g.jsx)(re.a.Item,{label:"M\xf4 t\u1ea3",name:"description",children:Object(g.jsx)(oe.a.TextArea,{placeholder:"Nh\u1eadp m\xf4 t\u1ea3"})})]})})})}var Ce=n(17),Ie=n(365),Ne=n(191),Re=n(193),ke=n.n(Re),Ue=["fetchOptions","debounceTimeout"];function Ae(e){var t=e.fetchOptions,n=e.debounceTimeout,c=void 0===n?300:n,r=Object(Ce.a)(e,Ue),i=Object(a.useState)(!1),o=Object(V.a)(i,2),s=o[0],l=o[1],d=Object(a.useState)([]),u=Object(V.a)(d,2),j=u[0],b=u[1],p=Object(a.useMemo)((function(){return Object(Ne.debounce)((function(e){b([]),l(!0),t(e,r.currentMembers).then((function(e){b(e),l(!1)}))}),c)}),[b,l,t,c]);return Object(g.jsx)(Ie.a,Object(x.a)(Object(x.a)({labelInValue:!0,filterOption:!1,onSearch:p,notFoundContent:s?Object(g.jsx)(L.a,{size:"small"}):null},r),{},{children:j&&j.map((function(e){var t,n;return Object(g.jsxs)(Ie.a.Option,{value:e.value,title:e.label,children:[Object(g.jsx)(ke.a,{size:"small",src:e.photoURL,children:e.photoURL?"":null===(t=e.label)||void 0===t||null===(n=t.charAt(0))||void 0===n?void 0:n.toUpperCase()})," ".concat(e.label," ")]},e.id)}))}))}function Se(){var e=Object(a.useContext)(z),t=e.isInviteMemberVisible,n=e.setIsInviteMemberVisible,c=e.selectedRoomId,r=e.selectedRoom,i=(Object(a.useContext)(M).user.uid,Object(a.useState)(null)),l=Object(V.a)(i,2),d=l[0],u=l[1],j=re.a.useForm(),b=Object(V.a)(j,1)[0],p=function(){var e=Object(s.a)(Object(o.a)().mark((function e(){var t,a;return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.collection("rooms").doc(c),e.next=3,a.update({members:(t=O.firestore.FieldValue).arrayUnion.apply(t,Object(m.a)(d.map((function(e){return e.value}))))});case 3:b.resetFields(),n(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(s.a)(Object(o.a)().mark((function e(t,n){return Object(o.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h.collection("users").where("keywords","array-contains",t).orderBy("displayName").limit(20).get().then((function(e){return e.docs.map((function(e){return{id:e.id,label:e.data().displayName,photoURL:e.data().photoURL,value:e.data().uid}})).filter((function(e){return-1===n.indexOf(e.value)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return console.log(d),Object(g.jsx)("div",{children:Object(g.jsx)(ye.a,{title:"M\u1eddi th\xeam th\xe0nh vi\xean",visible:t,onOk:p,onCancel:function(){b.resetFields(),n(!1)},children:Object(g.jsx)(re.a,{form:b,layout:"vertical",children:Object(g.jsx)(Ae,{mode:"multiple",label:"T\xean th\xe0nh vi\xean",value:d,placeholder:"T\xean th\xe0nh vi\xean",fetchOptions:x,onChange:function(e){return u(e)},style:{width:"100%"},currentMembers:r.members})})})})}var Ve=function(){return Object(g.jsx)(N.a,{children:Object(g.jsx)(F,{children:Object(g.jsxs)(E,{children:[Object(g.jsxs)(R.c,{children:[Object(g.jsx)(R.a,{component:I,path:"/login"}),Object(g.jsx)(R.a,{component:ge,path:"/"})]}),Object(g.jsx)(we,{}),Object(g.jsx)(Se,{})]})})})};i.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(Ve,{})}),document.getElementById("root"))}},[[351,1,2]]]);
//# sourceMappingURL=main.c6d931ce.chunk.js.map